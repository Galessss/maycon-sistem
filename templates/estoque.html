{% extends 'base.html' %}

{% block content %}
<style>
    .estoque-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
    }
    .estoque-header h2 {
        margin: 0;
        font-size: 24px;
        color: #fafafa;
    }
    .btn-novo-produto {
        padding: 10px 16px;
        background-color: #fafafa;
        color: #18181b;
        text-decoration: none;
        border-radius: 6px;
        font-weight: 600;
        font-size: 14px;
        transition: opacity 0.2s;
    }
    .btn-novo-produto:hover { opacity: 0.9; }

    .table-container {
        background-color: #18181b;
        border: 1px solid #27272a;
        border-radius: 12px;
        overflow: hidden;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        text-align: left;
    }
    th {
        background-color: #1c1c1f;
        padding: 16px;
        font-size: 13px;
        color: #a1a1aa;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        border-bottom: 1px solid #27272a;
    }
    td {
        padding: 16px;
        font-size: 14px;
        color: #fafafa;
        border-bottom: 1px solid #27272a;
    }
    tr:last-child td { border-bottom: none; }
    tr:hover { background-color: #27272a; transition: background 0.2s; }

    /* Badge de Stock */
    .badge-estoque {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 600;
    }
    .status-ok { background-color: #052e16; color: #4ade80; }
    .status-baixo { background-color: #450a0a; color: #f87171; }
    .status-zerado { background-color: #27272a; color: #a1a1aa; border: 1px solid #3f3f46; }
    .estoque-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
    .estoque-header h2 { margin: 0; font-size: 24px; color: #fafafa; }
    .btn-novo-produto { padding: 10px 16px; background-color: #fafafa; color: #18181b; text-decoration: none; border-radius: 6px; font-weight: 600; font-size: 14px; }

    .table-container { background-color: #18181b; border: 1px solid #27272a; border-radius: 12px; overflow: hidden; }
    table { width: 100%; border-collapse: collapse; text-align: left; }
    th { background-color: #1c1c1f; padding: 16px; font-size: 13px; color: #a1a1aa; border-bottom: 1px solid #27272a; }
    td { padding: 16px; font-size: 14px; color: #fafafa; border-bottom: 1px solid #27272a; }

    /* Novo estilo para o botão de deletar */
    .btn-deletar {
        color: #ef4444;
        text-decoration: none;
        font-size: 13px;
        padding: 6px 10px;
        border: 1px solid #450a0a;
        border-radius: 4px;
        transition: 0.2s;
    }
    .btn-deletar:hover { background-color: #450a0a; color: #fca5a5; }

    .badge-estoque { padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600; }
    .status-ok { background-color: #052e16; color: #4ade80; }
    .status-baixo { background-color: #450a0a; color: #f87171; }
    .status-zerado { background-color: #27272a; color: #a1a1aa; border: 1px solid #3f3f46; }
.form-estoque {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    .input-estoque {
        width: 60px;
        background: #09090b;
        border: 1px solid #27272a;
        color: white;
        padding: 4px;
        border-radius: 4px;
        text-align: center;
    }
    .btn-save-mini {
        background: #fafafa;
        border: none;
        color: #18181b;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 11px;
        cursor: pointer;
        font-weight: bold;
    }
    .btn-save-mini:hover { opacity: 0.8; }
</style>

<div class="estoque-header">
    <h2>Gestão de Estoque</h2>
    <a href="{% url 'cadastrar_produto' %}" class="btn-novo-produto">+ Novo Produto</a>
</div>

<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>Produto</th>
                <th>Preço</th>
                <th style="width: 150px;">Stock</th>
                <th>Status</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for produto in produtos %}
            <tr>
                <td><strong>{{ produto.nome }}</strong></td>
                <td>R$ {{ produto.preco_venda }}</td>
                <td>
                    <form action="{% url 'atualizar_estoque' produto.id %}" method="post" class="form-estoque">
                        {% csrf_token %}
                        <input type="number" name="quantidade" value="{{ produto.estoque }}" class="input-estoque">
                        <button type="submit" class="btn-save-mini">OK</button>
                    </form>
                </td>
                <td>
                    {% if produto.estoque > 5 %}
                        <span class="badge-estoque status-ok">Em Stock</span>
                    {% elif produto.estoque > 0 %}
                        <span class="badge-estoque status-baixo">Stock Baixo</span>
                    {% else %}
                        <span class="badge-estoque status-zerado">Estoque Zerado</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'deletar_produto' produto.id %}" 
                       class="btn-deletar" 
                       onclick="return confirm('Tem certeza que deseja excluir este produto?')">
                       Excluir
                    </a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="5" style="text-align: center; color: #a1a1aa; padding: 40px;">Nenhum produto cadastrado.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}